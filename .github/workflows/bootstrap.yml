name: Bootstrap Handball Site
on:
  push:
    paths:
      - ".github/workflows/bootstrap.yml"

permissions:
  contents: write

jobs:
  scaffold:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Generate project tree
        run: |
          set -eu
          mkdir -p public/assets public/data public/scripts/lib public/scripts/datafeeds public/scripts/ui .github/workflows

          ############
          # README.md
          ############
          cat > README.md <<'EOF'
          # ASV Handball ‚Äì GitHub Pages (ohne PWA)
          Moderne Sportseite: Live-Daten (nuLiga), Tabelle/Spielplan, Countdown, Formkurve (SVG),
          Jubel-Button (Konfetti+Sound), News (RSS optional), Dark/Light, Mobile-First.
          **Keine** Offline/PWA-Komplexit√§t. Deployment: GitHub Pages aus `/public`.

          ## Konfiguration
          `public/scripts/config.js`:
          - `nuliga.tableUrl` & `nuliga.scheduleUrl` setzen
          - optional `corsProxy: "https://r.jina.ai/http://"` bei CORS-Block
          - `clubFilter` (z. B. "ASV"), Branding (Name/Slogan)

          ## Lokal testen
          `cd public && python -m http.server 8080` ‚Üí http://localhost:8080

          Lizenz: MIT ¬∑ ‚ÄûFair. Vollgas. ASV!‚Äú
          EOF

          ##################
          # public/index.html
          ##################
          cat > public/index.html <<'EOF'
          <!doctype html>
          <html lang="de" data-theme="auto">
          <head>
            <meta charset="utf-8"/>
            <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
            <title>ASV Handball ¬∑ Live</title>
            <meta name="description" content="ASV Handball ‚Äì Live Scores, Tabelle, Spielplan. Fair. Vollgas. ASV!">
            <meta name="color-scheme" content="light dark">
            <link rel="icon" href="./assets/favicon.svg" type="image/svg+xml">
            <link rel="preload" as="style" href="./styles.css"/>
            <link rel="stylesheet" href="./styles.css" media="print" onload="this.media='all'">
            <noscript><link rel="stylesheet" href="./styles.css"></noscript>
            <style>
              html,body{height:100%} body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.5 system-ui,Segoe UI,Roboto,Inter,Arial}
              .wrap{max-width:1120px;margin:auto;padding:16px}
              .sr-only{position:absolute;width:1px;height:1px;margin:-1px;clip:rect(0,0,0,0);overflow:hidden}
            </style>
          </head>
          <body>
          <a class="sr-only" href="#content">Zum Inhalt springen</a>
          <div class="wrap">
            <header class="app" aria-label="Seitenkopf">
              <div class="brand">
                <img src="./assets/icon.svg" alt="" class="logo" width="40" height="40" aria-hidden="true">
                <div class="brand-lines">
                  <strong id="brand-title">ASV Handball</strong>
                  <span class="muted" id="brand-sub">Fair. Vollgas. ASV!</span>
                </div>
              </div>
              <nav class="actions" aria-label="Aktionen">
                <button id="btn-share" class="btn" aria-label="Seite teilen">Teilen</button>
                <button id="btn-theme" class="btn" aria-pressed="false" aria-label="Theme wechseln">üåó</button>
              </nav>
            </header>

            <main id="content" class="grid-3" aria-live="polite">
              <section class="card hero">
                <div class="hero-left">
                  <h1 id="hero-title">‚ÄûVolle Halle. Volle Herzen.‚Äú</h1>
                  <p class="muted">Live-Scores, Tabelle & Spielplan ‚Äì jetzt mit Konfetti-Risiko.</p>
                  <div class="cta-row">
                    <a href="#schedule" class="btn primary">Zum Spielplan</a>
                    <button class="btn" id="btn-cheer">üéâ Jubel!</button>
                  </div>
                </div>
                <div class="hero-right">
                  <div class="badge">Form: <strong id="form-value">‚Äì</strong></div>
                  <div class="countdown" id="countdown">‚Äì</div>
                </div>
              </section>

              <section class="card" id="table" aria-labelledby="table-h">
                <div class="card-head">
                  <h2 id="table-h">Tabelle</h2>
                  <div class="filters">
                    <label class="badge"><input id="flt-top" type="checkbox" checked> Top-3</label>
                    <span class="badge">‚è± <time id="tbl-updated">‚Äì</time></span>
                  </div>
                </div>
                <div id="table-body"><div class="skeleton h-240"></div></div>
                <div class="sparkline-wrap">
                  <svg id="form-spark" viewBox="0 0 100 30" role="img" aria-label="Formkurve letzte 5 Spiele"></svg>
                </div>
              </section>

              <section class="card" id="schedule" aria-labelledby="schedule-h">
                <div class="card-head">
                  <h2 id="schedule-h">Spielplan & Ergebnisse</h2>
                  <div class="filters">
                    <label class="badge"><input id="flt-only-asv" type="checkbox" checked> nur ASV</label>
                    <label class="badge"><input id="flt-upcoming" type="checkbox" checked> bevorstehend</label>
                  </div>
                </div>
                <div id="schedule-body"><div class="skeleton h-240"></div></div>
                <details id="iframe-fallback" class="mt-10" hidden>
                  <summary>Fallback: Original-Ansicht (nuLiga)</summary>
                  <iframe id="iframe-el" title="nuLiga Fallback" loading="lazy"></iframe>
                </details>
              </section>

              <section class="card" id="roster" aria-labelledby="roster-h">
                <div class="card-head">
                  <h2 id="roster-h">Team & Trainer</h2>
                  <span class="badge">Humor inside ü§ù</span>
                </div>
                <div id="roster-body"><div class="skeleton h-200"></div></div>
              </section>

              <section class="card" id="news" aria-labelledby="news-h">
                <div class="card-head">
                  <h2 id="news-h">Schlagzeilen</h2>
                  <span class="muted">Quelle: handball-world (RSS, sofern erlaubt)</span>
                </div>
                <div id="news-body"><div class="skeleton h-160"></div></div>
              </section>
            </main>

            <footer class="muted center">
              <small>¬© <span id="year"></span> ASV Handball ¬∑ ‚ÄûWirf‚Äôs wie du‚Äôs f√ºhlst.‚Äú</small>
            </footer>
          </div>
          <script type="module" src="./scripts/app.js" defer></script>
          </body>
          </html>
          EOF

          #################
          # public/styles.css
          #################
          cat > public/styles.css <<'EOF'
          :root{
            --asv-blue:#0046AD; --asv-red:#E21B23;
            --bg:#0B1020; --bg-soft:#12182b; --fg:#E9ECF4; --muted:#9aa4bf; --card:#0f1526;
            --ok:#10b981; --warn:#f59e0b; --err:#ef4444;
            --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.25);
            --border:#ffffff14; --transition:220ms ease;
          }
          @media (prefers-color-scheme: light){
            html[data-theme="auto"] :root{--bg:#f6f8ff;--bg-soft:#ffffff;--fg:#0b1020;--muted:#5c6680;--card:#ffffff;--border:#0001}
          }
          html[data-theme="light"] :root{--bg:#f6f8ff;--bg-soft:#ffffff;--fg:#0b1020;--muted:#5c6680;--card:#ffffff;--border:#0001}

          .wrap{max-width:1120px;margin:auto;padding:16px}
          .app{display:flex;gap:12px;align-items:center;justify-content:space-between}
          .brand{display:flex;gap:12px;align-items:center}
          .logo{width:40px;height:40px;border-radius:12px;box-shadow:var(--shadow)}
          .brand-lines strong{letter-spacing:.3px}
          .actions{display:flex;gap:8px;align-items:center}
          .grid-3{display:grid;gap:16px}
          @media(min-width:980px){.grid-3{grid-template-columns:2fr 1fr;grid-auto-rows:min-content}}
          .center{text-align:center}

          .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
          .card-head{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:8px}
          .badge{display:inline-flex;align-items:center;gap:6px;padding:3px 8px;border-radius:999px;background:#ffffff14;border:1px solid var(--border)}
          .muted{color:var(--muted)}

          .hero{display:grid;gap:16px}
          @media(min-width:980px){.hero{grid-template-columns:1.5fr 1fr}}
          .hero .cta-row{display:flex;gap:8px;align-items:center}
          .countdown{font-variant-numeric:tabular-nums;font-size:1.2rem;margin-top:8px}

          .btn{border:0;border-radius:999px;padding:10px 14px;cursor:pointer;background:var(--bg-soft);color:var(--fg);transition:transform var(--transition),opacity var(--transition)}
          .btn:hover{transform:translateY(-1px)}
          .btn.primary{background:linear-gradient(135deg,var(--asv-blue),var(--asv-red));color:#fff}

          .table{width:100%;border-collapse:collapse;font-variant-numeric:tabular-nums}
          .table th,.table td{padding:10px;border-bottom:1px solid var(--border);text-align:left}
          .table tr[data-asv="true"]{background:linear-gradient(90deg,transparent,rgba(226,27,35,.08),transparent)}
          .table tr:hover{background:#ffffff08}
          .skeleton{position:relative;overflow:hidden;background:linear-gradient(90deg,#ffffff10,#ffffff05,#ffffff10);border-radius:12px}
          .skeleton::after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.15),transparent);transform:translateX(-100%);animation:shimmer 1.2s infinite}
          @keyframes shimmer{to{transform:translateX(100%)}}
          .h-240{height:240px}.h-200{height:200px}.h-160{height:160px}
          .mt-10{margin-top:10px}

          #iframe-el{width:100%;height:520px;border:0;border-radius:12px;margin-top:10px}
          .sparkline-wrap{margin-top:10px}
          svg#form-spark{width:100%;height:40px}
          EOF

          ########################
          # public/assets/icon.svg
          ########################
          cat > public/assets/icon.svg <<'EOF'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96" role="img" aria-label="ASV Icon">
            <defs>
              <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0" stop-color="#0046AD"/>
                <stop offset="1" stop-color="#E21B23"/>
              </linearGradient>
            </defs>
            <rect rx="20" width="96" height="96" fill="url(#g)"/>
            <g fill="#fff">
              <circle cx="48" cy="48" r="22" opacity=".15"/>
              <path d="M25 60l10-32h8l10 32h-8l-2-7H33l-2 7h-6zm12-14h7l-3-11h-1l-3 11z"/>
              <circle cx="74" cy="28" r="6"/>
            </g>
          </svg>
          EOF

          #############################
          # public/assets/favicon.svg
          #############################
          cat > public/assets/favicon.svg <<'EOF'
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96">
            <rect rx="20" width="96" height="96" fill="#0046AD"/>
            <circle cx="72" cy="24" r="8" fill="#E21B23"/>
            <path d="M25 60l10-32h8l10 32h-8l-2-7H33l-2 7h-6zM37 46h7l-3-11h-1l-3 11z" fill="#fff"/>
          </svg>
          EOF

          #############################
          # public/data/roster.json
          #############################
          cat > public/data/roster.json <<'EOF'
          {
            "players": [
              { "nr": 1, "name": "Mika \"Mauer\" K.", "pos": "TW", "vibe": "Reflexe wie ein Panther üêÜ" },
              { "nr": 7, "name": "Lio ‚ÄûLaser‚Äú S.", "pos": "RL", "vibe": "Winkel? Kennt er alle üìê" },
              { "nr": 10, "name": "Yuna ‚ÄûYEAH-na‚Äú S.", "pos": "RR", "vibe": "Dreher-Queen üîÑ" },
              { "nr": 13, "name": "Leo ‚ÄûLaufwunder‚Äú B.", "pos": "LA", "vibe": "Konter-Kilometerz√§hler üèÉ‚Äç‚ôÇÔ∏è" }
            ],
            "staff": [
              { "role": "Head Coach", "name": "Coach K.", "fact": "Motivations-Playlist > Gegneranalyse üéß" },
              { "role": "Co-Trainer", "name": "Taktik T.", "fact": "Time-Out-Zeitfl√ºsterer ‚è±Ô∏è" }
            ]
          }
          EOF

          ###################################
          # public/data/schedule.sample.json
          ###################################
          cat > public/data/schedule.sample.json <<'EOF'
          [
            { "date": "2025-11-15T13:00:00", "home": "ASV S√ºchteln", "away": "HC Beispiel", "result": null },
            { "date": "2025-11-01T13:00:00", "home": "ASV S√ºchteln", "away": "SG Muster", "result": "22:20" },
            { "date": "2025-10-25T16:00:00", "home": "HSV Demo", "away": "ASV S√ºchteln", "result": "18:18" },
            { "date": "2025-10-18T14:30:00", "home": "ASV S√ºchteln", "away": "TV Sample", "result": "17:19" },
